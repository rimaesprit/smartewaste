{% extends 'BackBase.html.twig' %}

{% block title %}Détails de la poubelle{% endblock %}

{% block stylesheets %}
<style>
    .statut-badge {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 50px;
        font-weight: 600;
        font-size: 14px;
        text-align: center;
    }
    .statut-Fonctionnelle {
        background-color: #d4edda;
        color: #155724;
    }
    .statut-Hors-service {
        background-color: #f8d7da;
        color: #721c24;
    }
    .statut-En-maintenance {
        background-color: #fff3cd;
        color: #856404;
    }
    .detail-card {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 25px;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }
    .section-title {
        border-bottom: 2px solid #dee2e6;
        padding-bottom: 10px;
        margin-bottom: 20px;
        color: #495057;
    }
    .detail-label {
        font-weight: 600;
        color: #495057;
    }
    .map-container {
        height: 400px;
        border-radius: 8px;
        overflow: hidden;
        margin-top: 15px;
    }
    .progress {
        height: 25px;
    }
    .avis-card {
        border-left: 4px solid #007bff;
        padding: 15px;
        margin-bottom: 15px;
        background-color: #f8f9fa;
        border-radius: 0 8px 8px 0;
    }
    .star-rating {
        color: #ffc107;
    }
</style>
{% endblock %}

{% block body %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-trash"></i> Poubelle #{{ poubelle.id }}
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <th>ID</th>
                                            <td>{{ poubelle.id }}</td>
                                        </tr>
                                        <tr>
                                            <th>Localisation</th>
                                            <td>{{ poubelle.localisation }}</td>
                                        </tr>
                                        <tr>
                                            <th>Adresse</th>
                                            <td>{{ poubelle.adresse }}</td>
                                        </tr>
                                        <tr>
                                            <th>Type</th>
                                            <td>{{ poubelle.type }}</td>
                                        </tr>
                                        <tr>
                                            <th>Niveau de remplissage</th>
                                            <td>
                                                <div class="progress">
                                                    <div class="progress-bar {% if poubelle.niveauRemplissage >= 80 %}bg-danger{% elseif poubelle.niveauRemplissage >= 50 %}bg-warning{% else %}bg-success{% endif %}" 
                                                         role="progressbar" 
                                                         style="width: {{ poubelle.niveauRemplissage }}%"
                                                         aria-valuenow="{{ poubelle.niveauRemplissage }}" 
                                                         aria-valuemin="0" 
                                                         aria-valuemax="100">
                                                        {{ poubelle.niveauRemplissage }}%
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Statut</th>
                                            <td>
                                                <span class="badge {% if poubelle.statut == 'Fonctionnelle' %}bg-success{% elseif poubelle.statut == 'En maintenance' %}bg-warning{% else %}bg-danger{% endif %}">
                                                    {{ poubelle.statut }}
                                                </span>
                                            </td>
                                        </tr>
                                        {% if poubelle.latitude and poubelle.longitude %}
                                        <tr>
                                            <th>Coordonnées</th>
                                            <td>
                                                <small>Lat: {{ poubelle.latitude }}, Long: {{ poubelle.longitude }}</small>
                                            </td>
                                        </tr>
                                        {% endif %}
                                    </tbody>
                                </table>
                            </div>
                            {% if poubelle.latitude and poubelle.longitude %}
                            <div class="col-md-6">
                                <div id="map" style="height: 400px;"></div>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="mt-3">
                            <a href="{{ path('app_poubelle_index') }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Retour à la liste
                            </a>
                            <a href="{{ path('app_poubelle_edit', {'id': poubelle.id}) }}" class="btn btn-primary">
                                <i class="fas fa-edit"></i> Modifier
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if poubelle.latitude and poubelle.longitude %}
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var map = L.map('map').setView([{{ poubelle.latitude }}, {{ poubelle.longitude }}], 15);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
            
            L.marker([{{ poubelle.latitude }}, {{ poubelle.longitude }}])
                .addTo(map)
                .bindPopup("{{ poubelle.localisation }}<br>{{ poubelle.adresse }}");
        });
    </script>
    {% endif %}
{% endblock %} 